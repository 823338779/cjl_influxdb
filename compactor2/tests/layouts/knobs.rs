//! Module for testing / demonstrating how configuration parameters
//! (knobs) affect the compactor output.
//!
//! See [crate::layout] module for detailed documentation

use crate::layouts::{all_overlapping_l0_files, layout_setup_builder, run_layout_scenario, ONE_MB};

/// This test show the effects of the split_percentage parameter
#[tokio::test]
async fn all_overlapping_l0_split_percentage() {
    test_helpers::maybe_start_logging();

    //
    // configure to leave a smaller part of  data on the leading
    // edge.
    //
    // Expect to see two output files, one having the oldest 95
    // percent of the data, and one having the newest 5 percent.
    let setup = layout_setup_builder()
        .await
        .with_split_percentage(95)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                   "
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "**** Simulation run 0, type=split(split_times=[195]). 10 Input Files, 90mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1                                                                                                  "
    - "L1.?[100,195] 85.5mb|-----------------------------------L1.?-----------------------------------|    "
    - "L1.?[195,200] 4.5mb                                                                             |L1.?|"
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 2 files at level CompactionLevel::L1"
    - "**** Final Output Files "
    - "L1                                                                                                  "
    - "L1.11[100,195] 85.5mb|----------------------------------L1.11-----------------------------------|    "
    - "L1.12[195,200] 4.5mb                                                                            |L1.12|"
    "###
    );
}

/// This test show the effects of the percentage_max_file_size parameter
#[tokio::test]
async fn all_overlapping_l0_max_file_size() {
    test_helpers::maybe_start_logging();

    //
    // configure the max file size percentage to be 95%
    //
    // This means that the compactor will only apply the "leading
    // edge" optimization for data that is greater than 95 * 100MB =
    // 95MB in total
    //
    // Expect to see a single output file
    let setup = layout_setup_builder()
        .await
        .with_percentage_max_file_size(95)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                   "
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "**** Simulation run 0, type=compact. 10 Input Files, 90mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "**** 1 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1, all files 90mb                                                                                  "
    - "L1.?[100,200]       |-------------------------------------L1.?-------------------------------------|"
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 1 files at level CompactionLevel::L1"
    - "**** Final Output Files "
    - "L1, all files 90mb                                                                                  "
    - "L1.11[100,200]      |------------------------------------L1.11-------------------------------------|"
    "###
    );
}

/// This test show how the split percentage and max_file size ineract
#[tokio::test]
async fn all_overlapping_l0_split_percentage_and_max_file_size() {
    test_helpers::maybe_start_logging();

    // configure the max file size percentage to be 95% and the max file size to be 10MB
    //
    // This means that the compactor will only apply the "leading
    // edge" optimization for data that is greater than 95 * 10MB =
    // 9.5 MB in total
    //
    // Expect to see 8 ~11mb files, 1 file that s smaller
    let setup = layout_setup_builder()
        .await
        .with_max_desired_file_size_bytes(10 * ONE_MB)
        .with_percentage_max_file_size(95)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                   "
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "**** Simulation run 0, type=split(split_times=[112, 124, 136, 148, 160, 172, 184, 196]). 10 Input Files, 90mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "**** 9 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1                                                                                                  "
    - "L1.?[100,112] 10.8mb|-L1.?--|                                                                       "
    - "L1.?[112,124] 10.8mb         |-L1.?--|                                                              "
    - "L1.?[124,136] 10.8mb                   |-L1.?--|                                                    "
    - "L1.?[136,148] 10.8mb                            |-L1.?--|                                           "
    - "L1.?[148,160] 10.8mb                                      |-L1.?--|                                 "
    - "L1.?[160,172] 10.8mb                                                |-L1.?--|                       "
    - "L1.?[172,184] 10.8mb                                                         |-L1.?--|              "
    - "L1.?[184,196] 10.8mb                                                                   |-L1.?--|    "
    - "L1.?[196,200] 3.6mb                                                                             |L1.?|"
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 9 files at level CompactionLevel::L1"
    - "**** Simulation run 1, type=split(split_times=[112, 124, 136, 148, 160, 172, 184, 196]). 9 Input Files, 90mb total:"
    - "L1                                                                                                  "
    - "L1.19[196,200] 3.6mb                                                                            |L1.19|"
    - "L1.18[184,196] 10.8mb                                                                   |-L1.18-|    "
    - "L1.17[172,184] 10.8mb                                                         |-L1.17-|              "
    - "L1.16[160,172] 10.8mb                                                |-L1.16-|                       "
    - "L1.15[148,160] 10.8mb                                      |-L1.15-|                                 "
    - "L1.14[136,148] 10.8mb                            |-L1.14-|                                           "
    - "L1.13[124,136] 10.8mb                   |-L1.13-|                                                    "
    - "L1.12[112,124] 10.8mb         |-L1.12-|                                                              "
    - "L1.11[100,112] 10.8mb|-L1.11-|                                                                       "
    - "**** 9 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L2                                                                                                  "
    - "L2.?[100,112] 10.8mb|-L2.?--|                                                                       "
    - "L2.?[112,124] 10.8mb         |-L2.?--|                                                              "
    - "L2.?[124,136] 10.8mb                   |-L2.?--|                                                    "
    - "L2.?[136,148] 10.8mb                            |-L2.?--|                                           "
    - "L2.?[148,160] 10.8mb                                      |-L2.?--|                                 "
    - "L2.?[160,172] 10.8mb                                                |-L2.?--|                       "
    - "L2.?[172,184] 10.8mb                                                         |-L2.?--|              "
    - "L2.?[184,196] 10.8mb                                                                   |-L2.?--|    "
    - "L2.?[196,200] 3.6mb                                                                             |L2.?|"
    - "Committing partition 1:"
    - "  Soft Deleting 9 files: L1.11, L1.12, L1.13, L1.14, L1.15, L1.16, L1.17, L1.18, L1.19"
    - "  Creating 9 files at level CompactionLevel::L2"
    - "**** Final Output Files "
    - "L2                                                                                                  "
    - "L2.20[100,112] 10.8mb|-L2.20-|                                                                       "
    - "L2.21[112,124] 10.8mb         |-L2.21-|                                                              "
    - "L2.22[124,136] 10.8mb                   |-L2.22-|                                                    "
    - "L2.23[136,148] 10.8mb                            |-L2.23-|                                           "
    - "L2.24[148,160] 10.8mb                                      |-L2.24-|                                 "
    - "L2.25[160,172] 10.8mb                                                |-L2.25-|                       "
    - "L2.26[172,184] 10.8mb                                                         |-L2.26-|              "
    - "L2.27[184,196] 10.8mb                                                                   |-L2.27-|    "
    - "L2.28[196,200] 3.6mb                                                                            |L2.28|"
    "###
    );
}

/// This test show how the max_num_files_per_plan setting works
#[tokio::test]
async fn all_overlapping_l0_max_num_files_per_plan() {
    test_helpers::maybe_start_logging();

    // configure the max num files per plan to 3
    let setup = layout_setup_builder()
        .await
        .with_max_num_files_per_plan(3)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    // expect that each plan the compactor runs has at most three input files
    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                   "
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "**** Simulation run 0, type=split(split_times=[180]). 3 Input Files, 27mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 27mb total:"
    - "L0                                                                                                  "
    - "L0.?[100,180] 21.6mb|-----------------------------L0.?-----------------------------|                "
    - "L0.?[180,200] 5.4mb                                                                 |-----L0.?-----|"
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.1, L0.2, L0.3"
    - "  Creating 2 files at level CompactionLevel::L0"
    - "**** Simulation run 1, type=split(split_times=[180]). 3 Input Files, 27mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 27mb total:"
    - "L0                                                                                                  "
    - "L0.?[100,180] 21.6mb|-----------------------------L0.?-----------------------------|                "
    - "L0.?[180,200] 5.4mb                                                                 |-----L0.?-----|"
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.4, L0.5, L0.6"
    - "  Creating 2 files at level CompactionLevel::L0"
    - "**** Simulation run 2, type=split(split_times=[180]). 3 Input Files, 27mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 27mb total:"
    - "L0                                                                                                  "
    - "L0.?[100,180] 21.6mb|-----------------------------L0.?-----------------------------|                "
    - "L0.?[180,200] 5.4mb                                                                 |-----L0.?-----|"
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.7, L0.8, L0.9"
    - "  Creating 2 files at level CompactionLevel::L0"
    - "**** Simulation run 3, type=compact. 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "**** 1 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.?[100,200]       |-------------------------------------L0.?-------------------------------------|"
    - "Committing partition 1:"
    - "  Soft Deleting 1 files: L0.10"
    - "  Creating 1 files at level CompactionLevel::L0"
    - "**** Simulation run 4, type=split(split_times=[180]). 3 Input Files, 48.6mb total:"
    - "L0                                                                                                  "
    - "L0.11[100,180] 21.6mb|----------------------------L0.11-----------------------------|                "
    - "L0.12[180,200] 5.4mb                                                                |----L0.12-----|"
    - "L0.13[100,180] 21.6mb|----------------------------L0.13-----------------------------|                "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 48.6mb total:"
    - "L0                                                                                                  "
    - "L0.?[100,180] 38.88mb|-----------------------------L0.?-----------------------------|                "
    - "L0.?[180,200] 9.72mb                                                                |-----L0.?-----|"
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.11, L0.12, L0.13"
    - "  Creating 2 files at level CompactionLevel::L0"
    - "**** Simulation run 5, type=split(split_times=[180]). 3 Input Files, 32.4mb total:"
    - "L0                                                                                                  "
    - "L0.14[180,200] 5.4mb                                                                |----L0.14-----|"
    - "L0.15[100,180] 21.6mb|----------------------------L0.15-----------------------------|                "
    - "L0.16[180,200] 5.4mb                                                                |----L0.16-----|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 32.4mb total:"
    - "L0                                                                                                  "
    - "L0.?[100,180] 25.92mb|-----------------------------L0.?-----------------------------|                "
    - "L0.?[180,200] 6.48mb                                                                |-----L0.?-----|"
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.14, L0.15, L0.16"
    - "  Creating 2 files at level CompactionLevel::L0"
    - "**** Simulation run 6, type=compact. 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.17[100,200]      |------------------------------------L0.17-------------------------------------|"
    - "**** 1 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0, all files 9mb                                                                                   "
    - "L0.?[100,200]       |-------------------------------------L0.?-------------------------------------|"
    - "Committing partition 1:"
    - "  Soft Deleting 1 files: L0.17"
    - "  Creating 1 files at level CompactionLevel::L0"
    - "**** Simulation run 7, type=split(split_times=[180]). 3 Input Files, 74.52mb total:"
    - "L0                                                                                                  "
    - "L0.18[100,180] 38.88mb|----------------------------L0.18-----------------------------|                "
    - "L0.19[180,200] 9.72mb                                                                |----L0.19-----|"
    - "L0.20[100,180] 25.92mb|----------------------------L0.20-----------------------------|                "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 74.52mb total:"
    - "L0                                                                                                  "
    - "L0.?[100,180] 59.62mb|-----------------------------L0.?-----------------------------|                "
    - "L0.?[180,200] 14.9mb                                                                |-----L0.?-----|"
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.18, L0.19, L0.20"
    - "  Creating 2 files at level CompactionLevel::L0"
    - "**** Simulation run 8, type=compact. 2 Input Files, 15.48mb total:"
    - "L0                                                                                                  "
    - "L0.21[180,200] 6.48mb                                                                |----L0.21-----|"
    - "L0.22[100,200] 9mb  |------------------------------------L0.22-------------------------------------|"
    - "**** 1 Output Files (parquet_file_id not yet assigned), 15.48mb total:"
    - "L0, all files 15.48mb                                                                               "
    - "L0.?[100,200]       |-------------------------------------L0.?-------------------------------------|"
    - "Committing partition 1:"
    - "  Soft Deleting 2 files: L0.21, L0.22"
    - "  Creating 1 files at level CompactionLevel::L0"
    - "**** Simulation run 9, type=split(split_times=[180]). 3 Input Files, 90mb total:"
    - "L0                                                                                                  "
    - "L0.25[100,200] 15.48mb|------------------------------------L0.25-------------------------------------|"
    - "L0.24[180,200] 14.9mb                                                                |----L0.24-----|"
    - "L0.23[100,180] 59.62mb|----------------------------L0.23-----------------------------|                "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1                                                                                                  "
    - "L1.?[100,180] 72mb  |-----------------------------L1.?-----------------------------|                "
    - "L1.?[180,200] 18mb                                                                  |-----L1.?-----|"
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.23, L0.24, L0.25"
    - "  Creating 2 files at level CompactionLevel::L1"
    - "**** Final Output Files "
    - "L1                                                                                                  "
    - "L1.26[100,180] 72mb |----------------------------L1.26-----------------------------|                "
    - "L1.27[180,200] 18mb                                                                 |----L1.27-----|"
    "###
    );
}

/// This test show how the max_input_parquet_bytes_per_partition works
#[tokio::test]
async fn all_overlapping_l0_max_input_bytes_per_partition() {
    test_helpers::maybe_start_logging();

    // limit the plan to combining 30 mb at a time
    let setup = layout_setup_builder()
        .await
        .with_max_input_parquet_bytes_per_partition(30 * ONE_MB as usize)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    // expect that each plan the compactor runs has at most three input files
    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                   "
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    - "SKIPPED COMPACTION for PartitionId(1): partition 1 has 94371840 parquet file bytes, limit is 31457280"
    - "**** Final Output Files "
    - "L0, all files 9mb                                                                                   "
    - "L0.1[100,200]       |-------------------------------------L0.1-------------------------------------|"
    - "L0.2[100,200]       |-------------------------------------L0.2-------------------------------------|"
    - "L0.3[100,200]       |-------------------------------------L0.3-------------------------------------|"
    - "L0.4[100,200]       |-------------------------------------L0.4-------------------------------------|"
    - "L0.5[100,200]       |-------------------------------------L0.5-------------------------------------|"
    - "L0.6[100,200]       |-------------------------------------L0.6-------------------------------------|"
    - "L0.7[100,200]       |-------------------------------------L0.7-------------------------------------|"
    - "L0.8[100,200]       |-------------------------------------L0.8-------------------------------------|"
    - "L0.9[100,200]       |-------------------------------------L0.9-------------------------------------|"
    - "L0.10[100,200]      |------------------------------------L0.10-------------------------------------|"
    "###
    );
}
