//! layout tests for scenarios with large size overlapped files
//!
//! See [crate::layout] module for detailed documentation

use std::sync::Arc;

use data_types::CompactionLevel;
use iox_time::{MockProvider, Time, TimeProvider};

use crate::layouts::{layout_setup_builder, parquet_builder, run_layout_scenario, ONE_MB};

#[tokio::test]
async fn one_l1_overlaps_with_many_l2s() {
    // Simulate a production scenario in which there are two L1 files but one overlaps with three L2 files
    // and their total size > limit 256MB
    // |----------L2.1----------||----------L2.2----------||-----L2.3----|
    //  |----------------------------------------L1.4---------------------------||--L1.5--|

    test_helpers::maybe_start_logging();

    let setup = layout_setup_builder().await.build().await;
    let time_provider = Arc::new(MockProvider::new(Time::from_timestamp(0, 0).unwrap()));

    // L2: 100MB, 100MB, 70MB
    // L1: 100MB, 30MB

    // non-overlapping L2 files
    let mut num_l2_files = 0;
    for (i, sz) in [100, 100, 70].iter().enumerate() {
        let i = i as i64;
        setup
            .partition
            .create_parquet_file(
                parquet_builder()
                    .with_min_time(51 + i * 50)
                    .with_max_time(100 + i * 50)
                    .with_compaction_level(CompactionLevel::Final)
                    .with_file_size_bytes(sz * ONE_MB)
                    .with_max_l0_created_at(time_provider.minutes_into_future(i as u64)),
            )
            .await;
        num_l2_files += 1;
    }

    let l2_max_time: i64 = 100 + (num_l2_files - 1) * 50;
    // Non-overlapping L1 files but the first L1 file overlaps with all L2 files
    for (i, sz) in [100, 30].iter().enumerate() {
        setup
            .partition
            .create_parquet_file(
                parquet_builder()
                    .with_min_time(1 + i as i64 * (l2_max_time + 50))
                    .with_max_time((i as i64 + 1) * (l2_max_time + 50))
                    .with_compaction_level(CompactionLevel::FileNonOverlapped)
                    .with_file_size_bytes(sz * ONE_MB)
                    .with_max_l0_created_at(
                        time_provider.minutes_into_future(num_l2_files as u64 + i as u64 + 1),
                    ),
            )
            .await;
    }

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L1                                                                                                                 "
    - "L1.4[1,250] 240s 100mb   |-------------------L1.4-------------------|                                              "
    - "L1.5[251,500] 300s 30mb                                               |-------------------L1.5-------------------| "
    - "L2                                                                                                                 "
    - "L2.1[51,100] 0ns 100mb            |-L2.1-|                                                                         "
    - "L2.2[101,150] 60s 100mb                    |-L2.2-|                                                                "
    - "L2.3[151,200] 120s 70mb                             |-L2.3-|                                                       "
    - "**** Simulation run 0, type=split(split_times=[100, 150, 200]). 1 Input Files, 100mb total:"
    - "L1, all files 100mb                                                                                                "
    - "L1.4[1,250] 240s         |------------------------------------------L1.4------------------------------------------|"
    - "**** 4 Output Files (parquet_file_id not yet assigned), 100mb total:"
    - "L1                                                                                                                 "
    - "L1.?[1,100] 240s 39.76mb |--------------L1.?---------------|                                                       "
    - "L1.?[101,150] 240s 19.68mb                                    |-----L1.?------|                                     "
    - "L1.?[151,200] 240s 19.68mb                                                      |-----L1.?------|                   "
    - "L1.?[201,250] 240s 20.88mb                                                                        |-----L1.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 1 files: L1.4"
    - "  Creating 4 files"
    - "**** Simulation run 1, type=split(split_times=[72]). 2 Input Files, 139.76mb total:"
    - "L1                                                                                                                 "
    - "L1.6[1,100] 240s 39.76mb |-----------------------------------------L1.6------------------------------------------| "
    - "L2                                                                                                                 "
    - "L2.1[51,100] 0ns 100mb                                                |-------------------L2.1-------------------| "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 139.76mb total:"
    - "L2                                                                                                                 "
    - "L2.?[1,72] 240s 100.23mb |-----------------------------L2.?-----------------------------|                          "
    - "L2.?[73,100] 240s 39.53mb                                                                 |---------L2.?---------| "
    - "Committing partition 1:"
    - "  Soft Deleting 2 files: L2.1, L1.6"
    - "  Creating 2 files"
    - "**** Final Output Files "
    - "L1                                                                                                                 "
    - "L1.5[251,500] 300s 30mb                                               |-------------------L1.5-------------------| "
    - "L1.7[101,150] 240s 19.68mb                  |-L1.7-|                                                                "
    - "L1.8[151,200] 240s 19.68mb                           |-L1.8-|                                                       "
    - "L1.9[201,250] 240s 20.88mb                                    |-L1.9-|                                              "
    - "L2                                                                                                                 "
    - "L2.2[101,150] 60s 100mb                    |-L2.2-|                                                                "
    - "L2.3[151,200] 120s 70mb                             |-L2.3-|                                                       "
    - "L2.10[1,72] 240s 100.23mb|--L2.10---|                                                                              "
    - "L2.11[73,100] 240s 39.53mb            |L2.11|                                                                       "
    "###
    );
}

#[tokio::test]
async fn many_l1_overlaps_with_many_l2s() {
    // Simulate a production scenario in which many L1 files overlap with three L2 files
    // and their total size > limit 256MB
    // |------------L2.1------------||------------L2.2------------||-----L2.3----|
    // |---L1.4---||---L1.5---||-L1.6-||-L1.7-||--L1.8--||--L1.9--||--L1.10--|                      |--L1.11--|

    test_helpers::maybe_start_logging();

    let setup = layout_setup_builder().await.build().await;
    let time_provider = Arc::new(MockProvider::new(Time::from_timestamp(0, 0).unwrap()));

    // L2: 100MB, 100MB, 70MB
    // L1: 8 files each 13MB to have their total size > 100MB to force the compactor to compact them with overlapped L2 files

    // non-overlapping L2 files
    let mut num_l2_files = 0;
    for (i, sz) in [100, 100, 70].iter().enumerate() {
        let i = i as i64;
        setup
            .partition
            .create_parquet_file(
                parquet_builder()
                    .with_min_time(51 + i * 50)
                    .with_max_time(100 + i * 50)
                    .with_compaction_level(CompactionLevel::Final)
                    .with_file_size_bytes(sz * ONE_MB)
                    .with_max_l0_created_at(time_provider.minutes_into_future(i as u64)),
            )
            .await;
        num_l2_files += 1;
    }

    // Non-overlapping L1 files but they overlap with L2 files as in the diagram above
    let mut num_l1_files = 0;
    for (i, sz) in [13, 13, 13, 13, 13, 13, 13].iter().enumerate() {
        setup
            .partition
            .create_parquet_file(
                parquet_builder()
                    .with_min_time(61 + i as i64 * 15)
                    .with_max_time(75 + i as i64 * 15)
                    .with_compaction_level(CompactionLevel::FileNonOverlapped)
                    .with_file_size_bytes(sz * ONE_MB)
                    .with_max_l0_created_at(
                        time_provider.minutes_into_future(num_l2_files as u64 + i as u64 + 1),
                    ),
            )
            .await;
        num_l1_files += 1;
    }
    // Have the last L1 not overlap with anything
    setup
        .partition
        .create_parquet_file(
            parquet_builder()
                .with_min_time((num_l2_files as i64 + 1) * 50 + 1)
                .with_max_time((num_l2_files as i64 + 1) * 50 + 15)
                .with_compaction_level(CompactionLevel::FileNonOverlapped)
                .with_file_size_bytes(13 * ONE_MB)
                .with_max_l0_created_at(
                    time_provider
                        .minutes_into_future(num_l2_files as u64 + num_l1_files as u64 + 1),
                ),
        )
        .await;

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L1                                                                                                                 "
    - "L1.4[61,75] 240s 13mb         |L1.4-|                                                                              "
    - "L1.5[76,90] 300s 13mb                 |L1.5-|                                                                      "
    - "L1.6[91,105] 360s 13mb                        |L1.6-|                                                              "
    - "L1.7[106,120] 420s 13mb                                |L1.7-|                                                     "
    - "L1.8[121,135] 480s 13mb                                        |L1.8-|                                             "
    - "L1.9[136,150] 540s 13mb                                                |L1.9-|                                     "
    - "L1.10[151,165] 600s 13mb                                                       |L1.10|                             "
    - "L1.11[201,215] 660s 13mb                                                                                   |L1.11| "
    - "L2                                                                                                                 "
    - "L2.1[51,100] 0ns 100mb   |----------L2.1----------|                                                                "
    - "L2.2[101,150] 60s 100mb                             |----------L2.2----------|                                     "
    - "L2.3[151,200] 120s 70mb                                                        |----------L2.3----------|          "
    - "**** Simulation run 0, type=split(split_times=[100]). 1 Input Files, 13mb total:"
    - "L1, all files 13mb                                                                                                 "
    - "L1.6[91,105] 360s        |------------------------------------------L1.6------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[91,100] 360s 8.36mb |-------------------------L1.?--------------------------|                                 "
    - "L1.?[101,105] 360s 4.64mb                                                                |---------L1.?----------| "
    - "Committing partition 1:"
    - "  Soft Deleting 1 files: L1.6"
    - "  Creating 2 files"
    - "**** Simulation run 1, type=split(split_times=[91, 131]). 7 Input Files, 252mb total:"
    - "L1                                                                                                                 "
    - "L1.4[61,75] 240s 13mb             |---L1.4---|                                                                     "
    - "L1.5[76,90] 300s 13mb                          |---L1.5---|                                                        "
    - "L1.12[91,100] 360s 8.36mb                                    |L1.12-|                                              "
    - "L1.13[101,105] 360s 4.64mb                                             |L1.13|                                      "
    - "L1.7[106,120] 420s 13mb                                                   |---L1.7---|                             "
    - "L2                                                                                                                 "
    - "L2.1[51,100] 0ns 100mb   |-------------------L2.1-------------------|                                              "
    - "L2.2[101,150] 60s 100mb                                               |-------------------L2.2-------------------| "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 252mb total:"
    - "L2                                                                                                                 "
    - "L2.?[51,91] 420s 101.82mb|---------------L2.?---------------|                                                      "
    - "L2.?[92,131] 420s 99.27mb                                     |--------------L2.?---------------|                  "
    - "L2.?[132,150] 420s 50.91mb                                                                         |-----L2.?-----| "
    - "Committing partition 1:"
    - "  Soft Deleting 7 files: L2.1, L2.2, L1.4, L1.5, L1.7, L1.12, L1.13"
    - "  Creating 3 files"
    - "**** Final Output Files "
    - "L1                                                                                                                 "
    - "L1.8[121,135] 480s 13mb                                        |L1.8-|                                             "
    - "L1.9[136,150] 540s 13mb                                                |L1.9-|                                     "
    - "L1.10[151,165] 600s 13mb                                                       |L1.10|                             "
    - "L1.11[201,215] 660s 13mb                                                                                   |L1.11| "
    - "L2                                                                                                                 "
    - "L2.3[151,200] 120s 70mb                                                        |----------L2.3----------|          "
    - "L2.14[51,91] 420s 101.82mb|-------L2.14-------|                                                                     "
    - "L2.15[92,131] 420s 99.27mb                      |-------L2.15-------|                                               "
    - "L2.16[132,150] 420s 50.91mb                                            |-L2.16-|                                     "
    "###
    );
}

#[tokio::test]
async fn many_good_size_l0_files() {
    test_helpers::maybe_start_logging();

    // Scenario when we have a lot of L0 files because the compactor cannot keep up with ingesters
    // and each files is a good size, 2MB, which lead to total size of 200 files (limit num files)
    // greater than limit size (256MB)

    let two_mb = 2 * ONE_MB;

    let setup = layout_setup_builder().await.build().await;

    let num_files = (24 * 60) / 5; // 288 files

    for i in 0..num_files {
        let i = i as i64;
        setup
            .partition
            .create_parquet_file(
                parquet_builder()
                    .with_min_time(i)
                    .with_max_time(i + 1)
                    .with_compaction_level(CompactionLevel::Initial)
                    .with_file_size_bytes(two_mb),
            )
            .await;
    }

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 2mb                                                                                                  "
    - "L0.1[0,1] 1ns            |L0.1|                                                                                    "
    - "L0.2[1,2] 1ns            |L0.2|                                                                                    "
    - "L0.3[2,3] 1ns            |L0.3|                                                                                    "
    - "L0.4[3,4] 1ns            |L0.4|                                                                                    "
    - "L0.5[4,5] 1ns             |L0.5|                                                                                   "
    - "L0.6[5,6] 1ns             |L0.6|                                                                                   "
    - "L0.7[6,7] 1ns             |L0.7|                                                                                   "
    - "L0.8[7,8] 1ns              |L0.8|                                                                                  "
    - "L0.9[8,9] 1ns              |L0.9|                                                                                  "
    - "L0.10[9,10] 1ns            |L0.10|                                                                                 "
    - "L0.11[10,11] 1ns            |L0.11|                                                                                "
    - "L0.12[11,12] 1ns            |L0.12|                                                                                "
    - "L0.13[12,13] 1ns            |L0.13|                                                                                "
    - "L0.14[13,14] 1ns             |L0.14|                                                                               "
    - "L0.15[14,15] 1ns             |L0.15|                                                                               "
    - "L0.16[15,16] 1ns             |L0.16|                                                                               "
    - "L0.17[16,17] 1ns              |L0.17|                                                                              "
    - "L0.18[17,18] 1ns              |L0.18|                                                                              "
    - "L0.19[18,19] 1ns              |L0.19|                                                                              "
    - "L0.20[19,20] 1ns              |L0.20|                                                                              "
    - "L0.21[20,21] 1ns               |L0.21|                                                                             "
    - "L0.22[21,22] 1ns               |L0.22|                                                                             "
    - "L0.23[22,23] 1ns               |L0.23|                                                                             "
    - "L0.24[23,24] 1ns                |L0.24|                                                                            "
    - "L0.25[24,25] 1ns                |L0.25|                                                                            "
    - "L0.26[25,26] 1ns                |L0.26|                                                                            "
    - "L0.27[26,27] 1ns                 |L0.27|                                                                           "
    - "L0.28[27,28] 1ns                 |L0.28|                                                                           "
    - "L0.29[28,29] 1ns                 |L0.29|                                                                           "
    - "L0.30[29,30] 1ns                  |L0.30|                                                                          "
    - "L0.31[30,31] 1ns                  |L0.31|                                                                          "
    - "L0.32[31,32] 1ns                  |L0.32|                                                                          "
    - "L0.33[32,33] 1ns                   |L0.33|                                                                         "
    - "L0.34[33,34] 1ns                   |L0.34|                                                                         "
    - "L0.35[34,35] 1ns                   |L0.35|                                                                         "
    - "L0.36[35,36] 1ns                   |L0.36|                                                                         "
    - "L0.37[36,37] 1ns                    |L0.37|                                                                        "
    - "L0.38[37,38] 1ns                    |L0.38|                                                                        "
    - "L0.39[38,39] 1ns                    |L0.39|                                                                        "
    - "L0.40[39,40] 1ns                     |L0.40|                                                                       "
    - "L0.41[40,41] 1ns                     |L0.41|                                                                       "
    - "L0.42[41,42] 1ns                     |L0.42|                                                                       "
    - "L0.43[42,43] 1ns                      |L0.43|                                                                      "
    - "L0.44[43,44] 1ns                      |L0.44|                                                                      "
    - "L0.45[44,45] 1ns                      |L0.45|                                                                      "
    - "L0.46[45,46] 1ns                       |L0.46|                                                                     "
    - "L0.47[46,47] 1ns                       |L0.47|                                                                     "
    - "L0.48[47,48] 1ns                       |L0.48|                                                                     "
    - "L0.49[48,49] 1ns                        |L0.49|                                                                    "
    - "L0.50[49,50] 1ns                        |L0.50|                                                                    "
    - "L0.51[50,51] 1ns                        |L0.51|                                                                    "
    - "L0.52[51,52] 1ns                        |L0.52|                                                                    "
    - "L0.53[52,53] 1ns                         |L0.53|                                                                   "
    - "L0.54[53,54] 1ns                         |L0.54|                                                                   "
    - "L0.55[54,55] 1ns                         |L0.55|                                                                   "
    - "L0.56[55,56] 1ns                          |L0.56|                                                                  "
    - "L0.57[56,57] 1ns                          |L0.57|                                                                  "
    - "L0.58[57,58] 1ns                          |L0.58|                                                                  "
    - "L0.59[58,59] 1ns                           |L0.59|                                                                 "
    - "L0.60[59,60] 1ns                           |L0.60|                                                                 "
    - "L0.61[60,61] 1ns                           |L0.61|                                                                 "
    - "L0.62[61,62] 1ns                            |L0.62|                                                                "
    - "L0.63[62,63] 1ns                            |L0.63|                                                                "
    - "L0.64[63,64] 1ns                            |L0.64|                                                                "
    - "L0.65[64,65] 1ns                             |L0.65|                                                               "
    - "L0.66[65,66] 1ns                             |L0.66|                                                               "
    - "L0.67[66,67] 1ns                             |L0.67|                                                               "
    - "L0.68[67,68] 1ns                             |L0.68|                                                               "
    - "L0.69[68,69] 1ns                              |L0.69|                                                              "
    - "L0.70[69,70] 1ns                              |L0.70|                                                              "
    - "L0.71[70,71] 1ns                              |L0.71|                                                              "
    - "L0.72[71,72] 1ns                               |L0.72|                                                             "
    - "L0.73[72,73] 1ns                               |L0.73|                                                             "
    - "L0.74[73,74] 1ns                               |L0.74|                                                             "
    - "L0.75[74,75] 1ns                                |L0.75|                                                            "
    - "L0.76[75,76] 1ns                                |L0.76|                                                            "
    - "L0.77[76,77] 1ns                                |L0.77|                                                            "
    - "L0.78[77,78] 1ns                                 |L0.78|                                                           "
    - "L0.79[78,79] 1ns                                 |L0.79|                                                           "
    - "L0.80[79,80] 1ns                                 |L0.80|                                                           "
    - "L0.81[80,81] 1ns                                  |L0.81|                                                          "
    - "L0.82[81,82] 1ns                                  |L0.82|                                                          "
    - "L0.83[82,83] 1ns                                  |L0.83|                                                          "
    - "L0.84[83,84] 1ns                                  |L0.84|                                                          "
    - "L0.85[84,85] 1ns                                   |L0.85|                                                         "
    - "L0.86[85,86] 1ns                                   |L0.86|                                                         "
    - "L0.87[86,87] 1ns                                   |L0.87|                                                         "
    - "L0.88[87,88] 1ns                                    |L0.88|                                                        "
    - "L0.89[88,89] 1ns                                    |L0.89|                                                        "
    - "L0.90[89,90] 1ns                                    |L0.90|                                                        "
    - "L0.91[90,91] 1ns                                     |L0.91|                                                       "
    - "L0.92[91,92] 1ns                                     |L0.92|                                                       "
    - "L0.93[92,93] 1ns                                     |L0.93|                                                       "
    - "L0.94[93,94] 1ns                                      |L0.94|                                                      "
    - "L0.95[94,95] 1ns                                      |L0.95|                                                      "
    - "L0.96[95,96] 1ns                                      |L0.96|                                                      "
    - "L0.97[96,97] 1ns                                       |L0.97|                                                     "
    - "L0.98[97,98] 1ns                                       |L0.98|                                                     "
    - "L0.99[98,99] 1ns                                       |L0.99|                                                     "
    - "L0.100[99,100] 1ns                                     |L0.100|                                                    "
    - "L0.101[100,101] 1ns                                     |L0.101|                                                   "
    - "L0.102[101,102] 1ns                                     |L0.102|                                                   "
    - "L0.103[102,103] 1ns                                     |L0.103|                                                   "
    - "L0.104[103,104] 1ns                                      |L0.104|                                                  "
    - "L0.105[104,105] 1ns                                      |L0.105|                                                  "
    - "L0.106[105,106] 1ns                                      |L0.106|                                                  "
    - "L0.107[106,107] 1ns                                       |L0.107|                                                 "
    - "L0.108[107,108] 1ns                                       |L0.108|                                                 "
    - "L0.109[108,109] 1ns                                       |L0.109|                                                 "
    - "L0.110[109,110] 1ns                                        |L0.110|                                                "
    - "L0.111[110,111] 1ns                                        |L0.111|                                                "
    - "L0.112[111,112] 1ns                                        |L0.112|                                                "
    - "L0.113[112,113] 1ns                                         |L0.113|                                               "
    - "L0.114[113,114] 1ns                                         |L0.114|                                               "
    - "L0.115[114,115] 1ns                                         |L0.115|                                               "
    - "L0.116[115,116] 1ns                                         |L0.116|                                               "
    - "L0.117[116,117] 1ns                                          |L0.117|                                              "
    - "L0.118[117,118] 1ns                                          |L0.118|                                              "
    - "L0.119[118,119] 1ns                                          |L0.119|                                              "
    - "L0.120[119,120] 1ns                                           |L0.120|                                             "
    - "L0.121[120,121] 1ns                                           |L0.121|                                             "
    - "L0.122[121,122] 1ns                                           |L0.122|                                             "
    - "L0.123[122,123] 1ns                                            |L0.123|                                            "
    - "L0.124[123,124] 1ns                                            |L0.124|                                            "
    - "L0.125[124,125] 1ns                                            |L0.125|                                            "
    - "L0.126[125,126] 1ns                                             |L0.126|                                           "
    - "L0.127[126,127] 1ns                                             |L0.127|                                           "
    - "L0.128[127,128] 1ns                                             |L0.128|                                           "
    - "L0.129[128,129] 1ns                                              |L0.129|                                          "
    - "L0.130[129,130] 1ns                                              |L0.130|                                          "
    - "L0.131[130,131] 1ns                                              |L0.131|                                          "
    - "L0.132[131,132] 1ns                                              |L0.132|                                          "
    - "L0.133[132,133] 1ns                                               |L0.133|                                         "
    - "L0.134[133,134] 1ns                                               |L0.134|                                         "
    - "L0.135[134,135] 1ns                                               |L0.135|                                         "
    - "L0.136[135,136] 1ns                                                |L0.136|                                        "
    - "L0.137[136,137] 1ns                                                |L0.137|                                        "
    - "L0.138[137,138] 1ns                                                |L0.138|                                        "
    - "L0.139[138,139] 1ns                                                 |L0.139|                                       "
    - "L0.140[139,140] 1ns                                                 |L0.140|                                       "
    - "L0.141[140,141] 1ns                                                 |L0.141|                                       "
    - "L0.142[141,142] 1ns                                                  |L0.142|                                      "
    - "L0.143[142,143] 1ns                                                  |L0.143|                                      "
    - "L0.144[143,144] 1ns                                                  |L0.144|                                      "
    - "L0.145[144,145] 1ns                                                   |L0.145|                                     "
    - "L0.146[145,146] 1ns                                                   |L0.146|                                     "
    - "L0.147[146,147] 1ns                                                   |L0.147|                                     "
    - "L0.148[147,148] 1ns                                                   |L0.148|                                     "
    - "L0.149[148,149] 1ns                                                    |L0.149|                                    "
    - "L0.150[149,150] 1ns                                                    |L0.150|                                    "
    - "L0.151[150,151] 1ns                                                    |L0.151|                                    "
    - "L0.152[151,152] 1ns                                                     |L0.152|                                   "
    - "L0.153[152,153] 1ns                                                     |L0.153|                                   "
    - "L0.154[153,154] 1ns                                                     |L0.154|                                   "
    - "L0.155[154,155] 1ns                                                      |L0.155|                                  "
    - "L0.156[155,156] 1ns                                                      |L0.156|                                  "
    - "L0.157[156,157] 1ns                                                      |L0.157|                                  "
    - "L0.158[157,158] 1ns                                                       |L0.158|                                 "
    - "L0.159[158,159] 1ns                                                       |L0.159|                                 "
    - "L0.160[159,160] 1ns                                                       |L0.160|                                 "
    - "L0.161[160,161] 1ns                                                        |L0.161|                                "
    - "L0.162[161,162] 1ns                                                        |L0.162|                                "
    - "L0.163[162,163] 1ns                                                        |L0.163|                                "
    - "L0.164[163,164] 1ns                                                        |L0.164|                                "
    - "L0.165[164,165] 1ns                                                         |L0.165|                               "
    - "L0.166[165,166] 1ns                                                         |L0.166|                               "
    - "L0.167[166,167] 1ns                                                         |L0.167|                               "
    - "L0.168[167,168] 1ns                                                          |L0.168|                              "
    - "L0.169[168,169] 1ns                                                          |L0.169|                              "
    - "L0.170[169,170] 1ns                                                          |L0.170|                              "
    - "L0.171[170,171] 1ns                                                           |L0.171|                             "
    - "L0.172[171,172] 1ns                                                           |L0.172|                             "
    - "L0.173[172,173] 1ns                                                           |L0.173|                             "
    - "L0.174[173,174] 1ns                                                            |L0.174|                            "
    - "L0.175[174,175] 1ns                                                            |L0.175|                            "
    - "L0.176[175,176] 1ns                                                            |L0.176|                            "
    - "L0.177[176,177] 1ns                                                             |L0.177|                           "
    - "L0.178[177,178] 1ns                                                             |L0.178|                           "
    - "L0.179[178,179] 1ns                                                             |L0.179|                           "
    - "L0.180[179,180] 1ns                                                             |L0.180|                           "
    - "L0.181[180,181] 1ns                                                              |L0.181|                          "
    - "L0.182[181,182] 1ns                                                              |L0.182|                          "
    - "L0.183[182,183] 1ns                                                              |L0.183|                          "
    - "L0.184[183,184] 1ns                                                               |L0.184|                         "
    - "L0.185[184,185] 1ns                                                               |L0.185|                         "
    - "L0.186[185,186] 1ns                                                               |L0.186|                         "
    - "L0.187[186,187] 1ns                                                                |L0.187|                        "
    - "L0.188[187,188] 1ns                                                                |L0.188|                        "
    - "L0.189[188,189] 1ns                                                                |L0.189|                        "
    - "L0.190[189,190] 1ns                                                                 |L0.190|                       "
    - "L0.191[190,191] 1ns                                                                 |L0.191|                       "
    - "L0.192[191,192] 1ns                                                                 |L0.192|                       "
    - "L0.193[192,193] 1ns                                                                  |L0.193|                      "
    - "L0.194[193,194] 1ns                                                                  |L0.194|                      "
    - "L0.195[194,195] 1ns                                                                  |L0.195|                      "
    - "L0.196[195,196] 1ns                                                                  |L0.196|                      "
    - "L0.197[196,197] 1ns                                                                   |L0.197|                     "
    - "L0.198[197,198] 1ns                                                                   |L0.198|                     "
    - "L0.199[198,199] 1ns                                                                   |L0.199|                     "
    - "L0.200[199,200] 1ns                                                                    |L0.200|                    "
    - "L0.201[200,201] 1ns                                                                    |L0.201|                    "
    - "L0.202[201,202] 1ns                                                                    |L0.202|                    "
    - "L0.203[202,203] 1ns                                                                     |L0.203|                   "
    - "L0.204[203,204] 1ns                                                                     |L0.204|                   "
    - "L0.205[204,205] 1ns                                                                     |L0.205|                   "
    - "L0.206[205,206] 1ns                                                                      |L0.206|                  "
    - "L0.207[206,207] 1ns                                                                      |L0.207|                  "
    - "L0.208[207,208] 1ns                                                                      |L0.208|                  "
    - "L0.209[208,209] 1ns                                                                       |L0.209|                 "
    - "L0.210[209,210] 1ns                                                                       |L0.210|                 "
    - "L0.211[210,211] 1ns                                                                       |L0.211|                 "
    - "L0.212[211,212] 1ns                                                                       |L0.212|                 "
    - "L0.213[212,213] 1ns                                                                        |L0.213|                "
    - "L0.214[213,214] 1ns                                                                        |L0.214|                "
    - "L0.215[214,215] 1ns                                                                        |L0.215|                "
    - "L0.216[215,216] 1ns                                                                         |L0.216|               "
    - "L0.217[216,217] 1ns                                                                         |L0.217|               "
    - "L0.218[217,218] 1ns                                                                         |L0.218|               "
    - "L0.219[218,219] 1ns                                                                          |L0.219|              "
    - "L0.220[219,220] 1ns                                                                          |L0.220|              "
    - "L0.221[220,221] 1ns                                                                          |L0.221|              "
    - "L0.222[221,222] 1ns                                                                           |L0.222|             "
    - "L0.223[222,223] 1ns                                                                           |L0.223|             "
    - "L0.224[223,224] 1ns                                                                           |L0.224|             "
    - "L0.225[224,225] 1ns                                                                            |L0.225|            "
    - "L0.226[225,226] 1ns                                                                            |L0.226|            "
    - "L0.227[226,227] 1ns                                                                            |L0.227|            "
    - "L0.228[227,228] 1ns                                                                            |L0.228|            "
    - "L0.229[228,229] 1ns                                                                             |L0.229|           "
    - "L0.230[229,230] 1ns                                                                             |L0.230|           "
    - "L0.231[230,231] 1ns                                                                             |L0.231|           "
    - "L0.232[231,232] 1ns                                                                              |L0.232|          "
    - "L0.233[232,233] 1ns                                                                              |L0.233|          "
    - "L0.234[233,234] 1ns                                                                              |L0.234|          "
    - "L0.235[234,235] 1ns                                                                               |L0.235|         "
    - "L0.236[235,236] 1ns                                                                               |L0.236|         "
    - "L0.237[236,237] 1ns                                                                               |L0.237|         "
    - "L0.238[237,238] 1ns                                                                                |L0.238|        "
    - "L0.239[238,239] 1ns                                                                                |L0.239|        "
    - "L0.240[239,240] 1ns                                                                                |L0.240|        "
    - "L0.241[240,241] 1ns                                                                                 |L0.241|       "
    - "L0.242[241,242] 1ns                                                                                 |L0.242|       "
    - "L0.243[242,243] 1ns                                                                                 |L0.243|       "
    - "L0.244[243,244] 1ns                                                                                 |L0.244|       "
    - "L0.245[244,245] 1ns                                                                                  |L0.245|      "
    - "L0.246[245,246] 1ns                                                                                  |L0.246|      "
    - "L0.247[246,247] 1ns                                                                                  |L0.247|      "
    - "L0.248[247,248] 1ns                                                                                   |L0.248|     "
    - "L0.249[248,249] 1ns                                                                                   |L0.249|     "
    - "L0.250[249,250] 1ns                                                                                   |L0.250|     "
    - "L0.251[250,251] 1ns                                                                                    |L0.251|    "
    - "L0.252[251,252] 1ns                                                                                    |L0.252|    "
    - "L0.253[252,253] 1ns                                                                                    |L0.253|    "
    - "L0.254[253,254] 1ns                                                                                     |L0.254|   "
    - "L0.255[254,255] 1ns                                                                                     |L0.255|   "
    - "L0.256[255,256] 1ns                                                                                     |L0.256|   "
    - "L0.257[256,257] 1ns                                                                                      |L0.257|  "
    - "L0.258[257,258] 1ns                                                                                      |L0.258|  "
    - "L0.259[258,259] 1ns                                                                                      |L0.259|  "
    - "L0.260[259,260] 1ns                                                                                      |L0.260|  "
    - "L0.261[260,261] 1ns                                                                                       |L0.261| "
    - "L0.262[261,262] 1ns                                                                                       |L0.262| "
    - "L0.263[262,263] 1ns                                                                                       |L0.263| "
    - "L0.264[263,264] 1ns                                                                                        |L0.264|"
    - "L0.265[264,265] 1ns                                                                                        |L0.265|"
    - "L0.266[265,266] 1ns                                                                                        |L0.266|"
    - "L0.267[266,267] 1ns                                                                                         |L0.267|"
    - "L0.268[267,268] 1ns                                                                                         |L0.268|"
    - "L0.269[268,269] 1ns                                                                                         |L0.269|"
    - "L0.270[269,270] 1ns                                                                                          |L0.270|"
    - "L0.271[270,271] 1ns                                                                                          |L0.271|"
    - "L0.272[271,272] 1ns                                                                                          |L0.272|"
    - "L0.273[272,273] 1ns                                                                                           |L0.273|"
    - "L0.274[273,274] 1ns                                                                                           |L0.274|"
    - "L0.275[274,275] 1ns                                                                                           |L0.275|"
    - "L0.276[275,276] 1ns                                                                                           |L0.276|"
    - "L0.277[276,277] 1ns                                                                                            |L0.277|"
    - "L0.278[277,278] 1ns                                                                                            |L0.278|"
    - "L0.279[278,279] 1ns                                                                                            |L0.279|"
    - "L0.280[279,280] 1ns                                                                                             |L0.280|"
    - "L0.281[280,281] 1ns                                                                                             |L0.281|"
    - "L0.282[281,282] 1ns                                                                                             |L0.282|"
    - "L0.283[282,283] 1ns                                                                                              |L0.283|"
    - "L0.284[283,284] 1ns                                                                                              |L0.284|"
    - "L0.285[284,285] 1ns                                                                                              |L0.285|"
    - "L0.286[285,286] 1ns                                                                                               |L0.286|"
    - "L0.287[286,287] 1ns                                                                                               |L0.287|"
    - "L0.288[287,288] 1ns                                                                                               |L0.288|"
    - "**** Simulation run 0, type=split(split_times=[50, 100]). 128 Input Files, 256mb total:"
    - "L0, all files 2mb                                                                                                  "
    - "L0.1[0,1] 1ns            |L0.1|                                                                                    "
    - "L0.2[1,2] 1ns            |L0.2|                                                                                    "
    - "L0.3[2,3] 1ns             |L0.3|                                                                                   "
    - "L0.4[3,4] 1ns              |L0.4|                                                                                  "
    - "L0.5[4,5] 1ns              |L0.5|                                                                                  "
    - "L0.6[5,6] 1ns               |L0.6|                                                                                 "
    - "L0.7[6,7] 1ns                |L0.7|                                                                                "
    - "L0.8[7,8] 1ns                |L0.8|                                                                                "
    - "L0.9[8,9] 1ns                 |L0.9|                                                                               "
    - "L0.10[9,10] 1ns                |L0.10|                                                                             "
    - "L0.11[10,11] 1ns                |L0.11|                                                                            "
    - "L0.12[11,12] 1ns                |L0.12|                                                                            "
    - "L0.13[12,13] 1ns                 |L0.13|                                                                           "
    - "L0.14[13,14] 1ns                  |L0.14|                                                                          "
    - "L0.15[14,15] 1ns                  |L0.15|                                                                          "
    - "L0.16[15,16] 1ns                   |L0.16|                                                                         "
    - "L0.17[16,17] 1ns                    |L0.17|                                                                        "
    - "L0.18[17,18] 1ns                    |L0.18|                                                                        "
    - "L0.19[18,19] 1ns                     |L0.19|                                                                       "
    - "L0.20[19,20] 1ns                      |L0.20|                                                                      "
    - "L0.21[20,21] 1ns                       |L0.21|                                                                     "
    - "L0.22[21,22] 1ns                       |L0.22|                                                                     "
    - "L0.23[22,23] 1ns                        |L0.23|                                                                    "
    - "L0.24[23,24] 1ns                         |L0.24|                                                                   "
    - "L0.25[24,25] 1ns                         |L0.25|                                                                   "
    - "L0.26[25,26] 1ns                          |L0.26|                                                                  "
    - "L0.27[26,27] 1ns                           |L0.27|                                                                 "
    - "L0.28[27,28] 1ns                           |L0.28|                                                                 "
    - "L0.29[28,29] 1ns                            |L0.29|                                                                "
    - "L0.30[29,30] 1ns                             |L0.30|                                                               "
    - "L0.31[30,31] 1ns                              |L0.31|                                                              "
    - "L0.32[31,32] 1ns                              |L0.32|                                                              "
    - "L0.33[32,33] 1ns                               |L0.33|                                                             "
    - "L0.34[33,34] 1ns                                |L0.34|                                                            "
    - "L0.35[34,35] 1ns                                |L0.35|                                                            "
    - "L0.36[35,36] 1ns                                 |L0.36|                                                           "
    - "L0.37[36,37] 1ns                                  |L0.37|                                                          "
    - "L0.38[37,38] 1ns                                   |L0.38|                                                         "
    - "L0.39[38,39] 1ns                                   |L0.39|                                                         "
    - "L0.40[39,40] 1ns                                    |L0.40|                                                        "
    - "L0.41[40,41] 1ns                                     |L0.41|                                                       "
    - "L0.42[41,42] 1ns                                     |L0.42|                                                       "
    - "L0.43[42,43] 1ns                                      |L0.43|                                                      "
    - "L0.44[43,44] 1ns                                       |L0.44|                                                     "
    - "L0.45[44,45] 1ns                                       |L0.45|                                                     "
    - "L0.46[45,46] 1ns                                        |L0.46|                                                    "
    - "L0.47[46,47] 1ns                                         |L0.47|                                                   "
    - "L0.48[47,48] 1ns                                          |L0.48|                                                  "
    - "L0.49[48,49] 1ns                                          |L0.49|                                                  "
    - "L0.50[49,50] 1ns                                           |L0.50|                                                 "
    - "L0.51[50,51] 1ns                                            |L0.51|                                                "
    - "L0.52[51,52] 1ns                                            |L0.52|                                                "
    - "L0.53[52,53] 1ns                                             |L0.53|                                               "
    - "L0.54[53,54] 1ns                                              |L0.54|                                              "
    - "L0.55[54,55] 1ns                                              |L0.55|                                              "
    - "L0.56[55,56] 1ns                                               |L0.56|                                             "
    - "L0.57[56,57] 1ns                                                |L0.57|                                            "
    - "L0.58[57,58] 1ns                                                 |L0.58|                                           "
    - "L0.59[58,59] 1ns                                                 |L0.59|                                           "
    - "L0.60[59,60] 1ns                                                  |L0.60|                                          "
    - "L0.61[60,61] 1ns                                                   |L0.61|                                         "
    - "L0.62[61,62] 1ns                                                   |L0.62|                                         "
    - "L0.63[62,63] 1ns                                                    |L0.63|                                        "
    - "L0.64[63,64] 1ns                                                     |L0.64|                                       "
    - "L0.65[64,65] 1ns                                                      |L0.65|                                      "
    - "L0.66[65,66] 1ns                                                      |L0.66|                                      "
    - "L0.67[66,67] 1ns                                                       |L0.67|                                     "
    - "L0.68[67,68] 1ns                                                        |L0.68|                                    "
    - "L0.69[68,69] 1ns                                                        |L0.69|                                    "
    - "L0.70[69,70] 1ns                                                         |L0.70|                                   "
    - "L0.71[70,71] 1ns                                                          |L0.71|                                  "
    - "L0.72[71,72] 1ns                                                          |L0.72|                                  "
    - "L0.73[72,73] 1ns                                                           |L0.73|                                 "
    - "L0.74[73,74] 1ns                                                            |L0.74|                                "
    - "L0.75[74,75] 1ns                                                             |L0.75|                               "
    - "L0.76[75,76] 1ns                                                             |L0.76|                               "
    - "L0.77[76,77] 1ns                                                              |L0.77|                              "
    - "L0.78[77,78] 1ns                                                               |L0.78|                             "
    - "L0.79[78,79] 1ns                                                               |L0.79|                             "
    - "L0.80[79,80] 1ns                                                                |L0.80|                            "
    - "L0.81[80,81] 1ns                                                                 |L0.81|                           "
    - "L0.82[81,82] 1ns                                                                 |L0.82|                           "
    - "L0.83[82,83] 1ns                                                                  |L0.83|                          "
    - "L0.84[83,84] 1ns                                                                   |L0.84|                         "
    - "L0.85[84,85] 1ns                                                                    |L0.85|                        "
    - "L0.86[85,86] 1ns                                                                    |L0.86|                        "
    - "L0.87[86,87] 1ns                                                                     |L0.87|                       "
    - "L0.88[87,88] 1ns                                                                      |L0.88|                      "
    - "L0.89[88,89] 1ns                                                                      |L0.89|                      "
    - "L0.90[89,90] 1ns                                                                       |L0.90|                     "
    - "L0.91[90,91] 1ns                                                                        |L0.91|                    "
    - "L0.92[91,92] 1ns                                                                        |L0.92|                    "
    - "L0.93[92,93] 1ns                                                                         |L0.93|                   "
    - "L0.94[93,94] 1ns                                                                          |L0.94|                  "
    - "L0.95[94,95] 1ns                                                                           |L0.95|                 "
    - "L0.96[95,96] 1ns                                                                           |L0.96|                 "
    - "L0.97[96,97] 1ns                                                                            |L0.97|                "
    - "L0.98[97,98] 1ns                                                                             |L0.98|               "
    - "L0.99[98,99] 1ns                                                                             |L0.99|               "
    - "L0.100[99,100] 1ns                                                                            |L0.100|             "
    - "L0.101[100,101] 1ns                                                                            |L0.101|            "
    - "L0.102[101,102] 1ns                                                                             |L0.102|           "
    - "L0.103[102,103] 1ns                                                                             |L0.103|           "
    - "L0.104[103,104] 1ns                                                                              |L0.104|          "
    - "L0.105[104,105] 1ns                                                                               |L0.105|         "
    - "L0.106[105,106] 1ns                                                                               |L0.106|         "
    - "L0.107[106,107] 1ns                                                                                |L0.107|        "
    - "L0.108[107,108] 1ns                                                                                 |L0.108|       "
    - "L0.109[108,109] 1ns                                                                                 |L0.109|       "
    - "L0.110[109,110] 1ns                                                                                  |L0.110|      "
    - "L0.111[110,111] 1ns                                                                                   |L0.111|     "
    - "L0.112[111,112] 1ns                                                                                    |L0.112|    "
    - "L0.113[112,113] 1ns                                                                                    |L0.113|    "
    - "L0.114[113,114] 1ns                                                                                     |L0.114|   "
    - "L0.115[114,115] 1ns                                                                                      |L0.115|  "
    - "L0.116[115,116] 1ns                                                                                      |L0.116|  "
    - "L0.117[116,117] 1ns                                                                                       |L0.117| "
    - "L0.118[117,118] 1ns                                                                                        |L0.118|"
    - "L0.119[118,119] 1ns                                                                                        |L0.119|"
    - "L0.120[119,120] 1ns                                                                                         |L0.120|"
    - "L0.121[120,121] 1ns                                                                                          |L0.121|"
    - "L0.122[121,122] 1ns                                                                                           |L0.122|"
    - "L0.123[122,123] 1ns                                                                                           |L0.123|"
    - "L0.124[123,124] 1ns                                                                                            |L0.124|"
    - "L0.125[124,125] 1ns                                                                                             |L0.125|"
    - "L0.126[125,126] 1ns                                                                                             |L0.126|"
    - "L0.127[126,127] 1ns                                                                                              |L0.127|"
    - "L0.128[127,128] 1ns                                                                                               |L0.128|"
    - "**** 3 Output Files (parquet_file_id not yet assigned), 256mb total:"
    - "L0                                                                                                                 "
    - "L0.?[0,50] 1ns 100mb     |--------------L0.?---------------|                                                       "
    - "L0.?[51,100] 1ns 98mb                                       |--------------L0.?--------------|                     "
    - "L0.?[101,128] 1ns 58mb                                                                          |------L0.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 128 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10, L0.11, L0.12, L0.13, L0.14, L0.15, L0.16, L0.17, L0.18, L0.19, L0.20, L0.21, L0.22, L0.23, L0.24, L0.25, L0.26, L0.27, L0.28, L0.29, L0.30, L0.31, L0.32, L0.33, L0.34, L0.35, L0.36, L0.37, L0.38, L0.39, L0.40, L0.41, L0.42, L0.43, L0.44, L0.45, L0.46, L0.47, L0.48, L0.49, L0.50, L0.51, L0.52, L0.53, L0.54, L0.55, L0.56, L0.57, L0.58, L0.59, L0.60, L0.61, L0.62, L0.63, L0.64, L0.65, L0.66, L0.67, L0.68, L0.69, L0.70, L0.71, L0.72, L0.73, L0.74, L0.75, L0.76, L0.77, L0.78, L0.79, L0.80, L0.81, L0.82, L0.83, L0.84, L0.85, L0.86, L0.87, L0.88, L0.89, L0.90, L0.91, L0.92, L0.93, L0.94, L0.95, L0.96, L0.97, L0.98, L0.99, L0.100, L0.101, L0.102, L0.103, L0.104, L0.105, L0.106, L0.107, L0.108, L0.109, L0.110, L0.111, L0.112, L0.113, L0.114, L0.115, L0.116, L0.117, L0.118, L0.119, L0.120, L0.121, L0.122, L0.123, L0.124, L0.125, L0.126, L0.127, L0.128"
    - "  Creating 3 files"
    - "**** Simulation run 1, type=split(split_times=[178, 228]). 128 Input Files, 256mb total:"
    - "L0, all files 2mb                                                                                                  "
    - "L0.129[128,129] 1ns      |L0.129|                                                                                  "
    - "L0.130[129,130] 1ns      |L0.130|                                                                                  "
    - "L0.131[130,131] 1ns       |L0.131|                                                                                 "
    - "L0.132[131,132] 1ns        |L0.132|                                                                                "
    - "L0.133[132,133] 1ns        |L0.133|                                                                                "
    - "L0.134[133,134] 1ns         |L0.134|                                                                               "
    - "L0.135[134,135] 1ns          |L0.135|                                                                              "
    - "L0.136[135,136] 1ns          |L0.136|                                                                              "
    - "L0.137[136,137] 1ns           |L0.137|                                                                             "
    - "L0.138[137,138] 1ns            |L0.138|                                                                            "
    - "L0.139[138,139] 1ns             |L0.139|                                                                           "
    - "L0.140[139,140] 1ns             |L0.140|                                                                           "
    - "L0.141[140,141] 1ns              |L0.141|                                                                          "
    - "L0.142[141,142] 1ns               |L0.142|                                                                         "
    - "L0.143[142,143] 1ns               |L0.143|                                                                         "
    - "L0.144[143,144] 1ns                |L0.144|                                                                        "
    - "L0.145[144,145] 1ns                 |L0.145|                                                                       "
    - "L0.146[145,146] 1ns                 |L0.146|                                                                       "
    - "L0.147[146,147] 1ns                  |L0.147|                                                                      "
    - "L0.148[147,148] 1ns                   |L0.148|                                                                     "
    - "L0.149[148,149] 1ns                    |L0.149|                                                                    "
    - "L0.150[149,150] 1ns                    |L0.150|                                                                    "
    - "L0.151[150,151] 1ns                     |L0.151|                                                                   "
    - "L0.152[151,152] 1ns                      |L0.152|                                                                  "
    - "L0.153[152,153] 1ns                      |L0.153|                                                                  "
    - "L0.154[153,154] 1ns                       |L0.154|                                                                 "
    - "L0.155[154,155] 1ns                        |L0.155|                                                                "
    - "L0.156[155,156] 1ns                        |L0.156|                                                                "
    - "L0.157[156,157] 1ns                         |L0.157|                                                               "
    - "L0.158[157,158] 1ns                          |L0.158|                                                              "
    - "L0.159[158,159] 1ns                           |L0.159|                                                             "
    - "L0.160[159,160] 1ns                           |L0.160|                                                             "
    - "L0.161[160,161] 1ns                            |L0.161|                                                            "
    - "L0.162[161,162] 1ns                             |L0.162|                                                           "
    - "L0.163[162,163] 1ns                             |L0.163|                                                           "
    - "L0.164[163,164] 1ns                              |L0.164|                                                          "
    - "L0.165[164,165] 1ns                               |L0.165|                                                         "
    - "L0.166[165,166] 1ns                                |L0.166|                                                        "
    - "L0.167[166,167] 1ns                                |L0.167|                                                        "
    - "L0.168[167,168] 1ns                                 |L0.168|                                                       "
    - "L0.169[168,169] 1ns                                  |L0.169|                                                      "
    - "L0.170[169,170] 1ns                                  |L0.170|                                                      "
    - "L0.171[170,171] 1ns                                   |L0.171|                                                     "
    - "L0.172[171,172] 1ns                                    |L0.172|                                                    "
    - "L0.173[172,173] 1ns                                    |L0.173|                                                    "
    - "L0.174[173,174] 1ns                                     |L0.174|                                                   "
    - "L0.175[174,175] 1ns                                      |L0.175|                                                  "
    - "L0.176[175,176] 1ns                                       |L0.176|                                                 "
    - "L0.177[176,177] 1ns                                       |L0.177|                                                 "
    - "L0.178[177,178] 1ns                                        |L0.178|                                                "
    - "L0.179[178,179] 1ns                                         |L0.179|                                               "
    - "L0.180[179,180] 1ns                                         |L0.180|                                               "
    - "L0.181[180,181] 1ns                                          |L0.181|                                              "
    - "L0.182[181,182] 1ns                                           |L0.182|                                             "
    - "L0.183[182,183] 1ns                                           |L0.183|                                             "
    - "L0.184[183,184] 1ns                                            |L0.184|                                            "
    - "L0.185[184,185] 1ns                                             |L0.185|                                           "
    - "L0.186[185,186] 1ns                                              |L0.186|                                          "
    - "L0.187[186,187] 1ns                                              |L0.187|                                          "
    - "L0.188[187,188] 1ns                                               |L0.188|                                         "
    - "L0.189[188,189] 1ns                                                |L0.189|                                        "
    - "L0.190[189,190] 1ns                                                |L0.190|                                        "
    - "L0.191[190,191] 1ns                                                 |L0.191|                                       "
    - "L0.192[191,192] 1ns                                                  |L0.192|                                      "
    - "L0.193[192,193] 1ns                                                   |L0.193|                                     "
    - "L0.194[193,194] 1ns                                                   |L0.194|                                     "
    - "L0.195[194,195] 1ns                                                    |L0.195|                                    "
    - "L0.196[195,196] 1ns                                                     |L0.196|                                   "
    - "L0.197[196,197] 1ns                                                     |L0.197|                                   "
    - "L0.198[197,198] 1ns                                                      |L0.198|                                  "
    - "L0.199[198,199] 1ns                                                       |L0.199|                                 "
    - "L0.200[199,200] 1ns                                                       |L0.200|                                 "
    - "L0.201[200,201] 1ns                                                        |L0.201|                                "
    - "L0.202[201,202] 1ns                                                         |L0.202|                               "
    - "L0.203[202,203] 1ns                                                          |L0.203|                              "
    - "L0.204[203,204] 1ns                                                          |L0.204|                              "
    - "L0.205[204,205] 1ns                                                           |L0.205|                             "
    - "L0.206[205,206] 1ns                                                            |L0.206|                            "
    - "L0.207[206,207] 1ns                                                            |L0.207|                            "
    - "L0.208[207,208] 1ns                                                             |L0.208|                           "
    - "L0.209[208,209] 1ns                                                              |L0.209|                          "
    - "L0.210[209,210] 1ns                                                              |L0.210|                          "
    - "L0.211[210,211] 1ns                                                               |L0.211|                         "
    - "L0.212[211,212] 1ns                                                                |L0.212|                        "
    - "L0.213[212,213] 1ns                                                                 |L0.213|                       "
    - "L0.214[213,214] 1ns                                                                 |L0.214|                       "
    - "L0.215[214,215] 1ns                                                                  |L0.215|                      "
    - "L0.216[215,216] 1ns                                                                   |L0.216|                     "
    - "L0.217[216,217] 1ns                                                                   |L0.217|                     "
    - "L0.218[217,218] 1ns                                                                    |L0.218|                    "
    - "L0.219[218,219] 1ns                                                                     |L0.219|                   "
    - "L0.220[219,220] 1ns                                                                     |L0.220|                   "
    - "L0.221[220,221] 1ns                                                                      |L0.221|                  "
    - "L0.222[221,222] 1ns                                                                       |L0.222|                 "
    - "L0.223[222,223] 1ns                                                                        |L0.223|                "
    - "L0.224[223,224] 1ns                                                                        |L0.224|                "
    - "L0.225[224,225] 1ns                                                                         |L0.225|               "
    - "L0.226[225,226] 1ns                                                                          |L0.226|              "
    - "L0.227[226,227] 1ns                                                                          |L0.227|              "
    - "L0.228[227,228] 1ns                                                                           |L0.228|             "
    - "L0.229[228,229] 1ns                                                                            |L0.229|            "
    - "L0.230[229,230] 1ns                                                                             |L0.230|           "
    - "L0.231[230,231] 1ns                                                                             |L0.231|           "
    - "L0.232[231,232] 1ns                                                                              |L0.232|          "
    - "L0.233[232,233] 1ns                                                                               |L0.233|         "
    - "L0.234[233,234] 1ns                                                                               |L0.234|         "
    - "L0.235[234,235] 1ns                                                                                |L0.235|        "
    - "L0.236[235,236] 1ns                                                                                 |L0.236|       "
    - "L0.237[236,237] 1ns                                                                                 |L0.237|       "
    - "L0.238[237,238] 1ns                                                                                  |L0.238|      "
    - "L0.239[238,239] 1ns                                                                                   |L0.239|     "
    - "L0.240[239,240] 1ns                                                                                    |L0.240|    "
    - "L0.241[240,241] 1ns                                                                                    |L0.241|    "
    - "L0.242[241,242] 1ns                                                                                     |L0.242|   "
    - "L0.243[242,243] 1ns                                                                                      |L0.243|  "
    - "L0.244[243,244] 1ns                                                                                      |L0.244|  "
    - "L0.245[244,245] 1ns                                                                                       |L0.245| "
    - "L0.246[245,246] 1ns                                                                                        |L0.246|"
    - "L0.247[246,247] 1ns                                                                                        |L0.247|"
    - "L0.248[247,248] 1ns                                                                                         |L0.248|"
    - "L0.249[248,249] 1ns                                                                                          |L0.249|"
    - "L0.250[249,250] 1ns                                                                                           |L0.250|"
    - "L0.251[250,251] 1ns                                                                                           |L0.251|"
    - "L0.252[251,252] 1ns                                                                                            |L0.252|"
    - "L0.253[252,253] 1ns                                                                                             |L0.253|"
    - "L0.254[253,254] 1ns                                                                                             |L0.254|"
    - "L0.255[254,255] 1ns                                                                                              |L0.255|"
    - "L0.256[255,256] 1ns                                                                                               |L0.256|"
    - "**** 3 Output Files (parquet_file_id not yet assigned), 256mb total:"
    - "L0                                                                                                                 "
    - "L0.?[128,178] 1ns 100mb  |--------------L0.?---------------|                                                       "
    - "L0.?[179,228] 1ns 98mb                                      |--------------L0.?--------------|                     "
    - "L0.?[229,256] 1ns 58mb                                                                          |------L0.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 128 files: L0.129, L0.130, L0.131, L0.132, L0.133, L0.134, L0.135, L0.136, L0.137, L0.138, L0.139, L0.140, L0.141, L0.142, L0.143, L0.144, L0.145, L0.146, L0.147, L0.148, L0.149, L0.150, L0.151, L0.152, L0.153, L0.154, L0.155, L0.156, L0.157, L0.158, L0.159, L0.160, L0.161, L0.162, L0.163, L0.164, L0.165, L0.166, L0.167, L0.168, L0.169, L0.170, L0.171, L0.172, L0.173, L0.174, L0.175, L0.176, L0.177, L0.178, L0.179, L0.180, L0.181, L0.182, L0.183, L0.184, L0.185, L0.186, L0.187, L0.188, L0.189, L0.190, L0.191, L0.192, L0.193, L0.194, L0.195, L0.196, L0.197, L0.198, L0.199, L0.200, L0.201, L0.202, L0.203, L0.204, L0.205, L0.206, L0.207, L0.208, L0.209, L0.210, L0.211, L0.212, L0.213, L0.214, L0.215, L0.216, L0.217, L0.218, L0.219, L0.220, L0.221, L0.222, L0.223, L0.224, L0.225, L0.226, L0.227, L0.228, L0.229, L0.230, L0.231, L0.232, L0.233, L0.234, L0.235, L0.236, L0.237, L0.238, L0.239, L0.240, L0.241, L0.242, L0.243, L0.244, L0.245, L0.246, L0.247, L0.248, L0.249, L0.250, L0.251, L0.252, L0.253, L0.254, L0.255, L0.256"
    - "  Creating 3 files"
    - "**** Simulation run 2, type=split(split_times=[281]). 32 Input Files, 64mb total:"
    - "L0, all files 2mb                                                                                                  "
    - "L0.257[256,257] 1ns      |L0.257|                                                                                  "
    - "L0.258[257,258] 1ns        |L0.258|                                                                                "
    - "L0.259[258,259] 1ns           |L0.259|                                                                             "
    - "L0.260[259,260] 1ns              |L0.260|                                                                          "
    - "L0.261[260,261] 1ns                 |L0.261|                                                                       "
    - "L0.262[261,262] 1ns                    |L0.262|                                                                    "
    - "L0.263[262,263] 1ns                      |L0.263|                                                                  "
    - "L0.264[263,264] 1ns                         |L0.264|                                                               "
    - "L0.265[264,265] 1ns                            |L0.265|                                                            "
    - "L0.266[265,266] 1ns                               |L0.266|                                                         "
    - "L0.267[266,267] 1ns                                  |L0.267|                                                      "
    - "L0.268[267,268] 1ns                                    |L0.268|                                                    "
    - "L0.269[268,269] 1ns                                       |L0.269|                                                 "
    - "L0.270[269,270] 1ns                                          |L0.270|                                              "
    - "L0.271[270,271] 1ns                                             |L0.271|                                           "
    - "L0.272[271,272] 1ns                                                |L0.272|                                        "
    - "L0.273[272,273] 1ns                                                   |L0.273|                                     "
    - "L0.274[273,274] 1ns                                                     |L0.274|                                   "
    - "L0.275[274,275] 1ns                                                        |L0.275|                                "
    - "L0.276[275,276] 1ns                                                           |L0.276|                             "
    - "L0.277[276,277] 1ns                                                              |L0.277|                          "
    - "L0.278[277,278] 1ns                                                                 |L0.278|                       "
    - "L0.279[278,279] 1ns                                                                   |L0.279|                     "
    - "L0.280[279,280] 1ns                                                                      |L0.280|                  "
    - "L0.281[280,281] 1ns                                                                         |L0.281|               "
    - "L0.282[281,282] 1ns                                                                            |L0.282|            "
    - "L0.283[282,283] 1ns                                                                               |L0.283|         "
    - "L0.284[283,284] 1ns                                                                                 |L0.284|       "
    - "L0.285[284,285] 1ns                                                                                    |L0.285|    "
    - "L0.286[285,286] 1ns                                                                                       |L0.286| "
    - "L0.287[286,287] 1ns                                                                                          |L0.287|"
    - "L0.288[287,288] 1ns                                                                                             |L0.288|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 64mb total:"
    - "L0                                                                                                                 "
    - "L0.?[256,281] 1ns 50mb   |--------------------------------L0.?--------------------------------|                    "
    - "L0.?[282,288] 1ns 14mb                                                                            |-----L0.?-----| "
    - "Committing partition 1:"
    - "  Soft Deleting 32 files: L0.257, L0.258, L0.259, L0.260, L0.261, L0.262, L0.263, L0.264, L0.265, L0.266, L0.267, L0.268, L0.269, L0.270, L0.271, L0.272, L0.273, L0.274, L0.275, L0.276, L0.277, L0.278, L0.279, L0.280, L0.281, L0.282, L0.283, L0.284, L0.285, L0.286, L0.287, L0.288"
    - "  Creating 2 files"
    - "**** Simulation run 3, type=split(split_times=[229, 279]). 4 Input Files, 220mb total:"
    - "L0                                                                                                                 "
    - "L0.296[282,288] 1ns 14mb                                                                                      |L0.296|"
    - "L0.295[256,281] 1ns 50mb                                                                |------L0.295------|       "
    - "L0.294[229,256] 1ns 58mb                                          |-------L0.294-------|                           "
    - "L0.293[179,228] 1ns 98mb |----------------L0.293----------------|                                                  "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 220mb total:"
    - "L1                                                                                                                 "
    - "L1.?[179,229] 1ns 100.92mb|-----------------L1.?------------------|                                                 "
    - "L1.?[230,279] 1ns 98.9mb                                           |-----------------L1.?-----------------|        "
    - "L1.?[280,288] 1ns 20.18mb                                                                                   |L1.?| "
    - "Committing partition 1:"
    - "  Soft Deleting 4 files: L0.293, L0.294, L0.295, L0.296"
    - "  Upgrading 1 files level to CompactionLevel::L1: L0.289"
    - "  Creating 3 files"
    - "**** Simulation run 4, type=split(split_times=[101, 151]). 3 Input Files, 256mb total:"
    - "L0                                                                                                                 "
    - "L0.290[51,100] 1ns 98mb  |-------------L0.290-------------|                                                        "
    - "L0.291[101,128] 1ns 58mb                                    |-----L0.291------|                                    "
    - "L0.292[128,178] 1ns 100mb                                                      |-------------L0.292--------------| "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 256mb total:"
    - "L1                                                                                                                 "
    - "L1.?[51,101] 1ns 100.79mb|--------------L1.?---------------|                                                       "
    - "L1.?[102,151] 1ns 98.77mb                                    |--------------L1.?--------------|                    "
    - "L1.?[152,178] 1ns 56.44mb                                                                       |------L1.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.290, L0.291, L0.292"
    - "  Creating 3 files"
    - "**** Simulation run 5, type=split(split_times=[151]). 2 Input Files, 155.21mb total:"
    - "L1                                                                                                                 "
    - "L1.301[102,151] 1ns 98.77mb|-------------------------L1.301-------------------------|                                "
    - "L1.302[152,178] 1ns 56.44mb                                                           |-----------L1.302-----------| "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 155.21mb total:"
    - "L2                                                                                                                 "
    - "L2.?[102,151] 1ns 100.07mb|--------------------------L2.?--------------------------|                                "
    - "L2.?[152,178] 1ns 55.14mb                                                           |------------L2.?------------| "
    - "Committing partition 1:"
    - "  Soft Deleting 2 files: L1.301, L1.302"
    - "  Upgrading 2 files level to CompactionLevel::L2: L1.289, L1.300"
    - "  Creating 2 files"
    - "**** Simulation run 6, type=split(split_times=[276]). 2 Input Files, 119.08mb total:"
    - "L1                                                                                                                 "
    - "L1.299[280,288] 1ns 20.18mb                                                                             |--L1.299--| "
    - "L1.298[230,279] 1ns 98.9mb|----------------------------------L1.298----------------------------------|              "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 119.08mb total:"
    - "L2                                                                                                                 "
    - "L2.?[230,276] 1ns 94.44mb|--------------------------------L2.?---------------------------------|                   "
    - "L2.?[277,288] 1ns 24.64mb                                                                        |-----L2.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 2 files: L1.298, L1.299"
    - "  Upgrading 1 files level to CompactionLevel::L2: L1.297"
    - "  Creating 2 files"
    - "**** Final Output Files "
    - "L2                                                                                                                 "
    - "L2.289[0,50] 1ns 100mb   |---L2.289----|                                                                           "
    - "L2.297[179,229] 1ns 100.92mb                                                       |---L2.297----|                    "
    - "L2.300[51,101] 1ns 100.79mb               |---L2.300----|                                                            "
    - "L2.303[102,151] 1ns 100.07mb                               |---L2.303----|                                            "
    - "L2.304[152,178] 1ns 55.14mb                                               |L2.304|                                   "
    - "L2.305[230,276] 1ns 94.44mb                                                                       |---L2.305---|     "
    - "L2.306[277,288] 1ns 24.64mb                                                                                      |L2.306|"
    "###
    );
}
