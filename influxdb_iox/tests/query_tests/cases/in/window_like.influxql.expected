-- Test Setup: window_like
-- InfluxQL: SELECT difference(writes) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001;
name: diskio
+---------------------+------------+
| time                | difference |
+---------------------+------------+
| 1970-01-01T00:02:20 | 164        |
| 1970-01-01T00:02:30 | 187        |
| 1970-01-01T00:02:40 | 112        |
| 1970-01-01T00:02:50 | 110        |
| 1970-01-01T00:03:00 | 219        |
| 1970-01-01T00:03:10 | 75         |
| 1970-01-01T00:03:20 | 76         |
| 1970-01-01T00:03:30 | 146        |
+---------------------+------------+
-- InfluxQL: SELECT difference(usage_system) FROM cpu WHERE time >= 0000000060000000000 AND time < 0000000210000000001 AND cpu = 'cpu0';
name: cpu
+---------------------+---------------------+
| time                | difference          |
+---------------------+---------------------+
| 1970-01-01T00:01:10 | -0.9000000000000057 |
| 1970-01-01T00:01:30 | -5.199999999999989  |
| 1970-01-01T00:01:40 | 4.299999999999997   |
| 1970-01-01T00:02:10 | 2.0999999999999943  |
| 1970-01-01T00:02:50 | 0.0                 |
| 1970-01-01T00:03:00 | 0.20000000000000284 |
+---------------------+---------------------+
-- InfluxQL: SELECT difference(usage_idle) FROM cpu WHERE time >= 0000000130000000000 AND time < 0000000210000000001 AND cpu =~ /^cpu(0|1)$/ GROUP BY cpu;
name: cpu
tags: cpu=cpu0
+---------------------+----------------------+
| time                | difference           |
+---------------------+----------------------+
| 1970-01-01T00:02:20 | -0.7999999999999972  |
| 1970-01-01T00:02:30 | 1.4000000000000057   |
| 1970-01-01T00:02:40 | -0.20000000000000284 |
| 1970-01-01T00:02:50 | -0.4000000000000057  |
| 1970-01-01T00:03:00 | 0.20000000000000284  |
| 1970-01-01T00:03:10 | -1.2000000000000028  |
+---------------------+----------------------+
name: cpu
tags: cpu=cpu1
+---------------------+----------------------+
| time                | difference           |
+---------------------+----------------------+
| 1970-01-01T00:02:20 | 0.10000000000000853  |
| 1970-01-01T00:02:30 | 0.0                  |
| 1970-01-01T00:02:40 | -0.10000000000000853 |
| 1970-01-01T00:02:50 | 0.0                  |
| 1970-01-01T00:03:00 | 0.0                  |
| 1970-01-01T00:03:10 | 0.0                  |
+---------------------+----------------------+
-- InfluxQL: SELECT difference(mean(writes)) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s);
name: diskio
+---------------------+------------+
| time                | difference |
+---------------------+------------+
| 1970-01-01T00:02:20 | 164.0      |
| 1970-01-01T00:02:27 | 187.0      |
| 1970-01-01T00:02:34 | 112.0      |
| 1970-01-01T00:02:48 | 110.0      |
| 1970-01-01T00:02:55 | 219.0      |
| 1970-01-01T00:03:09 | 75.0       |
| 1970-01-01T00:03:16 | 76.0       |
| 1970-01-01T00:03:30 | 146.0      |
+---------------------+------------+
-- InfluxQL: SELECT difference(mean(writes)) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(30s);
name: diskio
+---------------------+-------------------+
| time                | difference        |
+---------------------+-------------------+
| 1970-01-01T00:02:00 | 389.3333333330229 |
| 1970-01-01T00:02:30 | 431.0             |
| 1970-01-01T00:03:00 | 405.0             |
| 1970-01-01T00:03:30 | 221.6666666669771 |
+---------------------+-------------------+
-- InfluxQL: SELECT difference(mean(writes)) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s) fill(0);
name: diskio
+---------------------+------------+
| time                | difference |
+---------------------+------------+
| 1970-01-01T00:02:06 | 5592646.0  |
| 1970-01-01T00:02:13 | -5592646.0 |
| 1970-01-01T00:02:20 | 5592810.0  |
| 1970-01-01T00:02:27 | 187.0      |
| 1970-01-01T00:02:34 | 112.0      |
| 1970-01-01T00:02:41 | -5593109.0 |
| 1970-01-01T00:02:48 | 5593219.0  |
| 1970-01-01T00:02:55 | 219.0      |
| 1970-01-01T00:03:02 | -5593438.0 |
| 1970-01-01T00:03:09 | 5593513.0  |
| 1970-01-01T00:03:16 | 76.0       |
| 1970-01-01T00:03:23 | -5593589.0 |
| 1970-01-01T00:03:30 | 5593735.0  |
+---------------------+------------+
-- InfluxQL: SELECT difference(mean(writes)) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s) fill(previous);
name: diskio
+---------------------+------------+
| time                | difference |
+---------------------+------------+
| 1970-01-01T00:02:13 | 0.0        |
| 1970-01-01T00:02:20 | 164.0      |
| 1970-01-01T00:02:27 | 187.0      |
| 1970-01-01T00:02:34 | 112.0      |
| 1970-01-01T00:02:41 | 0.0        |
| 1970-01-01T00:02:48 | 110.0      |
| 1970-01-01T00:02:55 | 219.0      |
| 1970-01-01T00:03:02 | 0.0        |
| 1970-01-01T00:03:09 | 75.0       |
| 1970-01-01T00:03:16 | 76.0       |
| 1970-01-01T00:03:23 | 0.0        |
| 1970-01-01T00:03:30 | 146.0      |
+---------------------+------------+
-- InfluxQL: SELECT difference(mean(writes)) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s) fill(linear);
name: diskio
+---------------------+------------+
| time                | difference |
+---------------------+------------+
| 1970-01-01T00:02:13 | 82.0       |
| 1970-01-01T00:02:20 | 82.0       |
| 1970-01-01T00:02:27 | 187.0      |
| 1970-01-01T00:02:34 | 112.0      |
| 1970-01-01T00:02:41 | 55.0       |
| 1970-01-01T00:02:48 | 55.0       |
| 1970-01-01T00:02:55 | 219.0      |
| 1970-01-01T00:03:02 | 37.5       |
| 1970-01-01T00:03:09 | 37.5       |
| 1970-01-01T00:03:16 | 76.0       |
| 1970-01-01T00:03:23 | 73.0       |
| 1970-01-01T00:03:30 | 73.0       |
+---------------------+------------+
-- InfluxQL: SELECT difference(mean(usage_idle)) FROM cpu WHERE time >= 0000000130000000000 AND time < 0000000210000000001 AND cpu =~ /^cpu(0|1)$/ GROUP BY TIME(30s), cpu;
name: cpu
tags: cpu=cpu0
+---------------------+---------------------+
| time                | difference          |
+---------------------+---------------------+
| 1970-01-01T00:02:00 | 0.36666666666666003 |
| 1970-01-01T00:02:30 | 1.566666666666677   |
| 1970-01-01T00:03:00 | -0.7333333333333343 |
+---------------------+---------------------+
name: cpu
tags: cpu=cpu1
+---------------------+----------------------+
| time                | difference           |
+---------------------+----------------------+
| 1970-01-01T00:02:00 | 0.36666666666667425  |
| 1970-01-01T00:02:30 | -0.03333333333334565 |
| 1970-01-01T00:03:00 | -0.03333333333333144 |
+---------------------+----------------------+
-- InfluxQL: SELECT non_negative_difference(usage_system) FROM cpu WHERE time >= 0000000060000000000 AND time < 0000000210000000001 AND cpu = 'cpu0';
name: cpu
+---------------------+-------------------------+
| time                | non_negative_difference |
+---------------------+-------------------------+
| 1970-01-01T00:01:40 | 4.299999999999997       |
| 1970-01-01T00:02:10 | 2.0999999999999943      |
| 1970-01-01T00:02:50 | 0.0                     |
| 1970-01-01T00:03:00 | 0.20000000000000284     |
+---------------------+-------------------------+
-- InfluxQL: SELECT non_negative_difference(usage_idle) FROM cpu WHERE time >= 0000000130000000000 AND time < 0000000210000000001 AND cpu = 'cpu0';
name: cpu
+---------------------+-------------------------+
| time                | non_negative_difference |
+---------------------+-------------------------+
| 1970-01-01T00:02:30 | 1.4000000000000057      |
| 1970-01-01T00:03:00 | 0.20000000000000284     |
+---------------------+-------------------------+
-- InfluxQL: SELECT non_negative_difference(usage_idle) FROM cpu WHERE time >= 0000000130000000000 AND time < 0000000210000000001 AND cpu =~ /^cpu(0|1)$/ GROUP BY cpu;
name: cpu
tags: cpu=cpu0
+---------------------+-------------------------+
| time                | non_negative_difference |
+---------------------+-------------------------+
| 1970-01-01T00:02:30 | 1.4000000000000057      |
| 1970-01-01T00:03:00 | 0.20000000000000284     |
+---------------------+-------------------------+
name: cpu
tags: cpu=cpu1
+---------------------+-------------------------+
| time                | non_negative_difference |
+---------------------+-------------------------+
| 1970-01-01T00:02:20 | 0.10000000000000853     |
| 1970-01-01T00:02:30 | 0.0                     |
| 1970-01-01T00:02:50 | 0.0                     |
| 1970-01-01T00:03:00 | 0.0                     |
| 1970-01-01T00:03:10 | 0.0                     |
+---------------------+-------------------------+
-- InfluxQL: SELECT non_negative_difference(mean(usage_idle)) FROM cpu WHERE time >= 0000000130000000000 AND time < 0000000210000000001 AND cpu =~ /^cpu(0|1)$/ GROUP BY TIME(30s), cpu;
name: cpu
tags: cpu=cpu0
+---------------------+-------------------------+
| time                | non_negative_difference |
+---------------------+-------------------------+
| 1970-01-01T00:02:00 | 0.36666666666666003     |
| 1970-01-01T00:02:30 | 1.566666666666677       |
+---------------------+-------------------------+
name: cpu
tags: cpu=cpu1
+---------------------+-------------------------+
| time                | non_negative_difference |
+---------------------+-------------------------+
| 1970-01-01T00:02:00 | 0.36666666666667425     |
+---------------------+-------------------------+
-- InfluxQL: SELECT moving_average(writes, 3) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001;
name: diskio
+---------------------+-------------------+
| time                | moving_average    |
+---------------------+-------------------+
| 1970-01-01T00:02:30 | 5592817.666666667 |
| 1970-01-01T00:02:40 | 5592972.0         |
| 1970-01-01T00:02:50 | 5593108.333333333 |
| 1970-01-01T00:03:00 | 5593255.333333333 |
| 1970-01-01T00:03:10 | 5593390.0         |
| 1970-01-01T00:03:20 | 5593513.333333333 |
| 1970-01-01T00:03:30 | 5593612.333333333 |
+---------------------+-------------------+
-- InfluxQL: SELECT moving_average(reads, 3) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001;
name: diskio
+---------------------+--------------------+
| time                | moving_average     |
+---------------------+--------------------+
| 1970-01-01T00:02:50 | 2592954.0          |
| 1970-01-01T00:03:00 | 2593218.0          |
| 1970-01-01T00:03:20 | 2593415.3333333335 |
| 1970-01-01T00:03:30 | 2593587.3333333335 |
+---------------------+--------------------+
-- InfluxQL: SELECT moving_average(writes, 3) FROM diskio WHERE time >= 0000000210000000000;
+------+----------------+
| time | moving_average |
+------+----------------+
+------+----------------+
-- InfluxQL: SELECT moving_average(writes, 3) FROM diskio WHERE time >= 0000000200000000000;
+------+----------------+
| time | moving_average |
+------+----------------+
+------+----------------+
-- InfluxQL: SELECT moving_average(writes, 3) FROM diskio WHERE time >= 0000000190000000000;
name: diskio
+---------------------+-------------------+
| time                | moving_average    |
+---------------------+-------------------+
| 1970-01-01T00:03:30 | 5593612.333333333 |
+---------------------+-------------------+
-- InfluxQL: SELECT moving_average(mean(writes), 3) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s);
name: diskio
+---------------------+-------------------+
| time                | moving_average    |
+---------------------+-------------------+
| 1970-01-01T00:02:27 | 5592817.666666667 |
| 1970-01-01T00:02:34 | 5592972.0         |
| 1970-01-01T00:02:48 | 5593108.333333333 |
| 1970-01-01T00:02:55 | 5593255.333333333 |
| 1970-01-01T00:03:09 | 5593390.0         |
| 1970-01-01T00:03:16 | 5593513.333333333 |
| 1970-01-01T00:03:30 | 5593612.333333333 |
+---------------------+-------------------+
-- InfluxQL: SELECT moving_average(mean(writes), 3) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s) fill(0);
name: diskio
+---------------------+--------------------+
| time                | moving_average     |
+---------------------+--------------------+
| 1970-01-01T00:02:13 | 1864215.3333333333 |
| 1970-01-01T00:02:20 | 3728485.3333333335 |
| 1970-01-01T00:02:27 | 3728602.3333333335 |
| 1970-01-01T00:02:34 | 5592972.0          |
| 1970-01-01T00:02:41 | 3728702.0          |
| 1970-01-01T00:02:48 | 3728776.0          |
| 1970-01-01T00:02:55 | 3728885.6666666665 |
| 1970-01-01T00:03:02 | 3728885.6666666665 |
| 1970-01-01T00:03:09 | 3728983.6666666665 |
| 1970-01-01T00:03:16 | 3729034.0          |
| 1970-01-01T00:03:23 | 3729034.0          |
| 1970-01-01T00:03:30 | 3729108.0          |
+---------------------+--------------------+
-- InfluxQL: SELECT moving_average(mean(writes), 3) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s) fill(previous);
name: diskio
+---------------------+-------------------+
| time                | moving_average    |
+---------------------+-------------------+
| 1970-01-01T00:02:20 | 5592700.666666667 |
| 1970-01-01T00:02:27 | 5592817.666666667 |
| 1970-01-01T00:02:34 | 5592972.0         |
| 1970-01-01T00:02:41 | 5593071.666666667 |
| 1970-01-01T00:02:48 | 5593145.666666667 |
| 1970-01-01T00:02:55 | 5593255.333333333 |
| 1970-01-01T00:03:02 | 5593365.0         |
| 1970-01-01T00:03:09 | 5593463.0         |
| 1970-01-01T00:03:16 | 5593513.333333333 |
| 1970-01-01T00:03:23 | 5593563.666666667 |
| 1970-01-01T00:03:30 | 5593637.666666667 |
+---------------------+-------------------+
-- InfluxQL: SELECT moving_average(mean(writes), 3) FROM diskio WHERE time >= 0000000130000000000 AND time < 0000000210000000001 GROUP BY time(7s) fill(linear);
name: diskio
+---------------------+-------------------+
| time                | moving_average    |
+---------------------+-------------------+
| 1970-01-01T00:02:20 | 5592728.0         |
| 1970-01-01T00:02:27 | 5592845.0         |
| 1970-01-01T00:02:34 | 5592972.0         |
| 1970-01-01T00:02:41 | 5593090.0         |
| 1970-01-01T00:02:48 | 5593164.0         |
| 1970-01-01T00:02:55 | 5593273.666666667 |
| 1970-01-01T00:03:02 | 5593377.5         |
| 1970-01-01T00:03:09 | 5593475.5         |
| 1970-01-01T00:03:16 | 5593525.833333333 |
| 1970-01-01T00:03:23 | 5593588.0         |
| 1970-01-01T00:03:30 | 5593662.0         |
+---------------------+-------------------+
-- InfluxQL: SELECT difference(usage_idle), non_negative_difference(usage_idle), moving_average(usage_idle, 4) FROM cpu WHERE time >= 0000000130000000000 AND time < 0000000210000000001 AND cpu =~ /^cpu(0|1)$/ GROUP BY cpu;
name: cpu
tags: cpu=cpu0
+---------------------+----------------------+-------------------------+-------------------+
| time                | difference           | non_negative_difference | moving_average    |
+---------------------+----------------------+-------------------------+-------------------+
| 1970-01-01T00:02:20 | -0.7999999999999972  |                         |                   |
| 1970-01-01T00:02:30 | 1.4000000000000057   | 1.4000000000000057      |                   |
| 1970-01-01T00:02:40 | -0.20000000000000284 |                         | 89.85000000000001 |
| 1970-01-01T00:02:50 | -0.4000000000000057  |                         | 89.85000000000001 |
| 1970-01-01T00:03:00 | 0.20000000000000284  | 0.20000000000000284     | 90.10000000000001 |
| 1970-01-01T00:03:10 | -1.2000000000000028  |                         | 89.7              |
+---------------------+----------------------+-------------------------+-------------------+
name: cpu
tags: cpu=cpu1
+---------------------+----------------------+-------------------------+-------------------+
| time                | difference           | non_negative_difference | moving_average    |
+---------------------+----------------------+-------------------------+-------------------+
| 1970-01-01T00:02:20 | 0.10000000000000853  | 0.10000000000000853     |                   |
| 1970-01-01T00:02:30 | 0.0                  | 0.0                     |                   |
| 1970-01-01T00:02:40 | -0.10000000000000853 |                         | 99.85000000000001 |
| 1970-01-01T00:02:50 | 0.0                  | 0.0                     | 99.85000000000001 |
| 1970-01-01T00:03:00 | 0.0                  | 0.0                     | 99.825            |
| 1970-01-01T00:03:10 | 0.0                  | 0.0                     | 99.8              |
+---------------------+----------------------+-------------------------+-------------------+
-- InfluxQL: SELECT difference(mean(usage_idle)), non_negative_difference(mean(usage_idle)), moving_average(mean(usage_idle), 4) FROM cpu WHERE time >= 0000000130000000000 AND time < 0000000210000000001 AND cpu =~ /^cpu(0|1)$/ GROUP BY TIME(30s), cpu;
name: cpu
tags: cpu=cpu0
+---------------------+---------------------+-------------------------+-------------------+
| time                | difference          | non_negative_difference | moving_average    |
+---------------------+---------------------+-------------------------+-------------------+
| 1970-01-01T00:02:00 | 0.36666666666666003 | 0.36666666666666003     |                   |
| 1970-01-01T00:02:30 | 1.566666666666677   | 1.566666666666677       |                   |
| 1970-01-01T00:03:00 | -0.7333333333333343 |                         | 89.07499999999999 |
+---------------------+---------------------+-------------------------+-------------------+
name: cpu
tags: cpu=cpu1
+---------------------+----------------------+-------------------------+----------------+
| time                | difference           | non_negative_difference | moving_average |
+---------------------+----------------------+-------------------------+----------------+
| 1970-01-01T00:02:00 | 0.36666666666667425  | 0.36666666666667425     |                |
| 1970-01-01T00:02:30 | -0.03333333333334565 |                         |                |
| 1970-01-01T00:03:00 | -0.03333333333333144 |                         | 99.75          |
+---------------------+----------------------+-------------------------+----------------+